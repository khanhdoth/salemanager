<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:fn="http://java.sun.com/jsp/jstl/functions">

    <ui:composition>

        <h:head>
            <title>#{bundle.App}</title>            
        </h:head>
        <h:body>


            <h:form id="form" onkeypress="return event.keyCode != 13;">
                <p:growl id="messages" showDetail="true"/>
                <p:menubar autoDisplay="false">  
                    <p:submenu label="#{bundle.ModuleContact}" >  
                        <p:menuitem value="#{bundle.New}" icon="ui-icon-document" onclick="createContact.show()" />  
                        <p:menuitem value="#{bundle.ShowList}" icon="ui-icon-document" onclick="dlg.show()" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModuleProduct}">  
                        <p:menuitem value="#{bundle.New}" icon="ui-icon-document" onclick="createContact.show()" /> 
                        <p:menuitem value="#{bundle.ShowList}" icon="ui-icon-document" onclick="dlg.show()" /> 
                    </p:submenu>  
                    <p:menuitem value="Quit" url="http://vannga.com" />  

                    <f:facet name="options">  
                        <p:inputText style="margin-right:10px"/>  
                        <p:commandButton type="button" value="Logout" icon="ui-icon-extlink" />  
                    </f:facet>  
                </p:menubar>

                <p:dialog header="New contact" widgetVar="createContact">
                    <h:panelGrid columns="2" cellpadding="5">  
                        <h:outputLabel for="fname" value="Name" style="font-weight:bold"/>  
                        <p:inputText id="fname" value="#{contactController.newContact.name}" />  

                        <h:outputLabel for="faddress" value="Address" style="font-weight:bold"/>  
                        <p:inputText id="faddress" value="#{contactController.newContact.address}" />  

                        <h:outputLabel for="fdistrict" value="District" style="font-weight:bold"/>  
                        <p:inputText id="fdistrict" value="#{contactController.newContact.district}" />  

                        <h:outputLabel for="fcity" value="City" style="font-weight:bold"/>  
                        <p:inputText id="fcity" value="#{contactController.newContact.city}" />  

                        <h:outputLabel for="fpostcode" value="Post code" style="font-weight:bold"/>  
                        <p:inputText id="fpostcode" value="#{contactController.newContact.postcode}" />  

                        <h:outputLabel for="fcountry" value="Country" style="font-weight:bold"/>  
                        <p:inputText id="fcountry" value="#{contactController.newContact.country}" />  

                        <h:outputLabel for="fmoreInfo" value="MoreInfo" style="font-weight:bold"/>  
                        <p:inputText id="fmoreInfo" value="#{contactController.newContact.moreInfo}" />  

                        <p:commandButton value="Create" actionListener="#{contactController.createContact}" update="dataTable"/>  
                    </h:panelGrid>  
                </p:dialog>

                <p:dialog header="Contact" widgetVar="dlg" position="bottom">

                    <p:contextMenu for="dataTable">  
                        <p:menuitem value="Delete" update="dataTable, messages" icon="ui-icon-close" actionListener="#{contactController.delete}"/>  
                    </p:contextMenu>

                    <p:dataTable id="dataTable" var="item" value="#{contactController.list}" editable="true"
                                 widgetVar="contactTable" rowKey="#{item.contactId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No contact found with given criteria" editMode="cell"
                                 filteredValue="#{contactController.filterList}"
                                 selection="#{contactController.selectedContact}" selectionMode="single"
                                 resizableColumns="true" liveResize="true" >   
                        <f:facet name="header">  
                            <p:outputPanel>  
                                <h:outputText value="Search all fields:" />  
                                <p:inputText id="globalFilter" onkeyup="contactTable.filter()" style="width:150px" />  
                            </p:outputPanel> 
                        </f:facet>
                        <p:ajax event="cellEdit" listener="#{contactController.onCellEdit}" update=":form:messages" /> 
                        <p:column id="contactIdColumn" sortBy="contactId" filterBy="contactId"   
                                  headerText="ID" filterMatchMode="contains">  
                            <h:outputText value="#{item.contactId}" />  
                        </p:column>  

                        <p:column id="nameColumn" sortBy="name" filterBy="name"   
                                  headerText="Name"
                                  filterMatchMode="contains">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.name}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.name}" style="width:100%"/>  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="addressColumn" sortBy="address" filterBy="address"   
                                  headerText="Address"
                                  filterMatchMode="contains">  
                            <h:outputText value="#{item.address}" />  
                        </p:column>  

                        <p:column id="districtColumn" sortBy="district" filterBy="district"   
                                  headerText="District"
                                  filterMatchMode="contains">  
                            <h:outputText value="#{item.district}" />  
                        </p:column>  

                        <p:column id="cityColumn" sortBy="city" filterBy="city"   
                                  headerText="City"
                                  filterMatchMode="contains">  
                            <h:outputText value="#{item.city}" />  
                        </p:column>  

                        <p:column id="countryColumn" sortBy="country" filterBy="country"   
                                  headerText="Country"
                                  filterMatchMode="contains">  
                            <h:outputText value="#{item.country}" />  
                        </p:column>  

                        <p:column id="postcodeColumn" sortBy="postcode" filterBy="postcode"   
                                  headerText="Postcode"
                                  filterMatchMode="contains">  
                            <h:outputText value="#{item.postcode}" />  
                        </p:column>  

                        <p:column id="moreInfoColumn" sortBy="moreInfo" filterBy="moreInfo"   
                                  headerText="More info"
                                  filterMatchMode="contains">  
                            <h:outputText value="#{item.moreInfo}" />  
                        </p:column>  
                        <p:column style="width:6%">  
                            <p:rowEditor />  
                        </p:column>
                    </p:dataTable>                     
                </p:dialog>
            </h:form>                
        </h:body>
    </ui:composition>
</html>

