<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:fn="http://java.sun.com/jsp/jstl/functions"
       xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:composition>

        <h:head>
            <title>#{bundle.App}</title>                
        </h:head>

        <h:body>
            <h:outputStylesheet name="css/default.css" />

            <p:ajaxStatus style="width:1px;height:1px;" id="ajaxStatusPanel">  
                <f:facet name="start">  
                    <h:graphicImage value="images/ajax_loader.gif" />  
                </f:facet>  

                <f:facet name="complete">   
                    <h:outputText value="" />  
                </f:facet>  
            </p:ajaxStatus> 

            <!-- menu -->            
            <h:form id="menuForm" onkeypress="return event.keyCode != 13;">
                <p:menubar autoDisplay="false">                      
                    <p:submenu label="#{bundle.ModuleStockOut}">  
                        <p:menuitem value="#{bundle.StockOut_NewStockOut}" icon="ui-icon-document" onclick="wDlgSale.show()" /> 
                        <p:menuitem value="#{bundle.StockOut_StockOutList}" icon="ui-icon-document" 
                                    onclick="wDlgSaleList.show()" action="#{stockOutController.refreshList}" 
                                    update=":saleListForm:iStockOutTable" />
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModuleStockIn}">  
                        <p:menuitem value="#{bundle.StockIn_NewStockIn}" icon="ui-icon-document" onclick="wDlgBuy.show()" /> 
                        <p:menuitem value="#{bundle.StockIn_StockInList}" icon="ui-icon-document" 
                                    onclick="wDlgBuyList.show()" action="#{stockInController.refreshList}" 
                                    update=":buyListForm:iStockInTable" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModuleReceipt}">  
                        <p:menuitem value="#{bundle.Receipt_NewReceipt}" icon="ui-icon-document" 
                                    onclick="wDlgReceipt.show()" /> 
                        <p:menuitem value="#{bundle.Receipt_ReceiptList}" icon="ui-icon-document" 
                                    onclick="wDlgReceiptList.show()" action="#{receiptController.refreshList}" 
                                    update=":receiptListForm:iReceiptTable" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModulePayment}">  
                        <p:menuitem value="#{bundle.Payment_NewPayment}" icon="ui-icon-document" 
                                    onclick="wDlgPayment.show()" action="#{contactController.refreshList}" 
                                    update=":createPaymentForm:soMenu" /> 

                        <p:menuitem value="#{bundle.Payment_PaymentList}" icon="ui-icon-document" 
                                    onclick="wDlgPaymentList.show()" action="#{paymentController.refreshList}" 
                                    update=":paymentListForm:iPaymentTable" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModuleContact}" >  
                        <p:menuitem value="#{bundle.Contact_NewContact}" icon="ui-icon-document" onclick="wDlgContact.show()" />  
                        <p:menuitem value="#{bundle.Contact_ContactList}" icon="ui-icon-document" 
                                    onclick="wDlgContactList.show()" action="#{contactController.refreshList}" 
                                    update=":ContactListForm:iContactTable" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModuleProduct}">  
                        <p:menuitem value="#{bundle.Product_NewProduct}" icon="ui-icon-document" onclick="wDlgProduct.show()" /> 
                        <p:menuitem value="#{bundle.Product_ProductList}" icon="ui-icon-document" onclick="wDlgProductList.show()" 
                                    action="#{productController.refreshList}" 
                                    update=":productListForm:iProductTable" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.Report}">  
                        <p:menuitem value="#{bundle.ReportContact}" icon="ui-icon-document" onclick="wDlgBusinessContactList.show()" /> 
                        <p:menuitem value="#{bundle.ReportBusiness}" icon="ui-icon-document" 
                                    onclick="wDlgBusinessList.show()" action="#{contactController.refreshList}" 
                                    update=":businessListForm:iPGBusinessList" />  
                    </p:submenu>
                    
                    <f:facet name="options">  
                        <p:inputText style="margin-right:10px"/>  
                        <p:commandButton type="button" value="#{bundle.Logout}" icon="ui-icon-extlink" />  
                    </f:facet>  
                </p:menubar>            
            </h:form>

            <!-- Main form -->            
            <h:form id="mainForm" onkeypress="return event.keyCode != 13;">                
                <p:growl id="messages" showDetail="true"/>

                <!-- Confirmation -->            
                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">  
                    <p:commandButton value="#{bundle.Yes}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>  
                    <p:commandButton value="#{bundle.No}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>       
                </p:confirmDialog>  
            </h:form>

            <!-- Business contact report -->            
            <h:form id="businessContactForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgBusinessContactList" header="#{bundle.ReportContact}" widgetVar="wDlgBusinessContactList" position="bottom">                                        
                    <p:panelGrid id="iPGBusinessContactList">
                        <p:row>
                            <p:column  style="width:100px; text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalStockOutAmount}" />  
                            </p:column>
                            <p:column  style="width:150px; text-align:right">
                                <h:outputText value="#{contactController.viewT.saleAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>                            
                            <p:column>
                                <h:outputLabel for="soContactMenu" value="#{bundle.ModuleContact} : " />  
                                <p:selectOneMenu id="soContactMenu" value="#{contactController.viewT}" converter="contactConverter"                                                  
                                                 panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                                 filter="true" filterMatchMode="contains" required="true">                              
                                    <f:selectItems value="#{contactController.listOne}" var="c" itemLabel="#{c.contactId} - #{c.name}" itemValue="#{c}"/>  
                                    <p:ajax update="iPGBusinessContactList"/>

                                    <p:column style="width:15px"> #{p.contactId} </p:column>
                                    <p:column> #{p.name} </p:column>
                                    <p:column style="width:25px"> #{p.address} </p:column>
                                    <p:column style="width:25px"> #{p.city} </p:column>
                                    <p:column style="width:25px"> #{p.country} </p:column>

                                </p:selectOneMenu> 
                            </p:column>
                            <p:column  style="width:100px; text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalStockInAmount}" />  
                            </p:column>
                            <p:column  style="width:150px; text-align:right">
                                <h:outputText value="#{contactController.viewT.buyAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column  style="text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalPaymentAmount}" />
                            </p:column>
                            <p:column  style="text-align:right">
                                <h:outputText value="#{contactController.viewT.paymentSentAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                            <p:column rowspan="2" styleClass="ui-widget-header"  style="text-align:center; font-size: 200%">
                                <h:outputLabel value="#{bundle.BalanceInHand}:" />
                                <p:spacer width="20"/>
                                <h:outputText value="#{contactController.viewT.balance}" >
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>                                    
                            </p:column>
                            <p:column  style="text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalReceiptAmount}" /> 
                            </p:column>
                            <p:column  style="text-align:right">
                                <h:outputText value="#{contactController.viewT.paymentReceivedAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column  styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputLabel value="#{bundle.Debit}" /> 
                            </p:column>
                            <p:column styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputText value="#{contactController.viewT.debit}" >
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                            <p:column  styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputLabel value="#{bundle.Credit}" /> 
                            </p:column>
                            <p:column  styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputText value="#{contactController.viewT.credit}" >
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                        </p:row>                                                
                    </p:panelGrid> 
                </p:dialog>
            </h:form>

            <!-- Business report -->            
            <h:form id="businessListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgBusinessList" header="#{bundle.ReportBusiness}" widgetVar="wDlgBusinessList" position="bottom">                    
                    <p:panelGrid id="iPGBusinessList">
                        <p:row>
                            <p:column  style="width:100px; text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalStockOutAmount}" />  
                            </p:column>
                            <p:column  style="width:150px; text-align:right">
                                <h:outputText value="#{contactController.businessStockOutAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>                            
                            <p:column rowspan="3" styleClass="ui-widget-header"  style="text-align:center; font-size: 200%">
                                <h:outputLabel value="#{bundle.BalanceInHand}:" />
                                <p:spacer width="20"/>
                                <h:outputText value="#{contactController.businessBalance}" >
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>                                    
                            </p:column>
                            <p:column  style="width:100px; text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalStockInAmount}" />  
                            </p:column>
                            <p:column  style="width:150px; text-align:right">
                                <h:outputText value="#{contactController.businessStockInAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column  style="text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalPaymentAmount}" />
                            </p:column>
                            <p:column  style="text-align:right">
                                <h:outputText value="#{contactController.businessPaymentAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                            <p:column  style="text-align:right; font-weight:bold">
                                <h:outputLabel value="#{bundle.TotalReceiptAmount}" /> 
                            </p:column>
                            <p:column  style="text-align:right">
                                <h:outputText value="#{contactController.businessReceiptAmount}" style="font-weight:bold; font-size: 120%">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column  styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputLabel value="#{bundle.Debit}" /> 
                            </p:column>
                            <p:column styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputText value="#{contactController.businessDebit}" >
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                            <p:column  styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputLabel value="#{bundle.Credit}" /> 
                            </p:column>
                            <p:column  styleClass="ui-widget-header"  style="text-align:right; font-size: 150%">
                                <h:outputText value="#{contactController.businessCredit}" >
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>
                        </p:row>                        
                        <p:row>
                            <p:column colspan="5" styleClass="ui-widget-header">
                                <p:dataTable id="iBusinessTable" var="item" value="#{contactController.list}"
                                             widgetVar="wBusinessTable" rowKey="#{item.contactId}" scrollable="true" scrollHeight="400"
                                             emptyMessage="No contact found with given criteria"
                                             filteredValue="#{contactController.filterList}"                                 
                                             resizableColumns="true" liveResize="true" >   

                                    <f:facet name="header">  
                                        <p:outputPanel style="text-align:left"> 
                                            <p:commandButton id="refreshButton" update=":businessListForm:iPGBusinessList" action="#{contactController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />
                                            <p:spacer width="20"/>
                                            <h:outputText value="#{bundle.Search}" />
                                            <p:spacer width="5"/>
                                            <p:inputText id="globalFilter" onkeyup="wBusinessTable.filter()" style="width:150px" />                                                            
                                        </p:outputPanel>
                                    </f:facet>

                                    <p:ajax event="cellEdit" listener="#{contactController.onCellEdit}" update=":mainForm:messages" /> 

                                    <p:column style="width:35px">  
                                        <p:commandButton id="editButton" update=":businessContactForm:iPGBusinessContactList" 
                                                         icon="ui-icon-search" title="#{bundle.View}" oncomplete="wDlgBusinessContactList.show()" >                                  
                                            <f:setPropertyActionListener value="#{item}" target="#{contactController.viewT}" />  
                                        </p:commandButton> 
                                    </p:column> 

                                    <p:column id="contactIdColumn" sortBy="contactId" filterBy="contactId"                                  
                                              headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px" >  
                                        <h:outputText value="#{item.contactId}" />  
                                    </p:column>  

                                    <p:column id="contactNameColumn" sortBy="name" filterBy="name"   
                                              headerText="#{bundle.Contact_Name}" filterMatchMode="contains">  
                                        <h:outputText value="#{item.name}" />  
                                    </p:column>

                                    <p:column id="stockInColumn" style="width:80px; text-align:right" sortBy="buyAmount">
                                        <f:facet name="header">
                                            <h:outputText value="#{bundle.TotalStockInAmount}" title="#{bundle.TotalStockInAmount} #{bundle.forCustomer}" />
                                        </f:facet>
                                        <h:outputText value="#{item.buyAmount}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>

                                    <p:column id="paymentColumn" style="width:80px; text-align:right" sortBy="paymentSentAmount">
                                        <f:facet name="header">
                                            <h:outputText value="#{bundle.TotalPaymentAmount}" title="#{bundle.TotalPaymentAmount} #{bundle.forCustomer}" />
                                        </f:facet>
                                        <h:outputText value="#{item.paymentSentAmount}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>

                                    <p:column id="stockOutColumn" style="width:80px; text-align:right" sortBy="saleAmount">
                                        <f:facet name="header">
                                            <h:outputText value="#{bundle.TotalStockOutAmount}" title="#{bundle.TotalStockOutAmount} #{bundle.forCustomer}" />
                                        </f:facet>
                                        <h:outputText value="#{item.saleAmount}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>

                                    <p:column id="receiptColumn" style="width:80px; text-align:right" sortBy="paymentReceivedAmount">
                                        <f:facet name="header">
                                            <h:outputText value="#{bundle.TotalReceiptAmount}" title="#{bundle.TotalReceiptAmount} #{bundle.forCustomer}" />
                                        </f:facet>
                                        <h:outputText value="#{item.paymentReceivedAmount}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>

                                    <p:column id="balanceColumn" style="width:80px; text-align:right" sortBy="balance">
                                        <f:facet name="header">
                                            <h:outputText value="#{bundle.BalanceInHand}" title="#{bundle.BalanceInHand} #{bundle.forCustomer}" />
                                        </f:facet>
                                        <h:outputText value="#{item.balance}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>

                                </p:dataTable>  
                            </p:column>
                        </p:row>
                    </p:panelGrid> 
                </p:dialog>
            </h:form>            

            <!-- Create contact -->            
            <h:form id="createContactForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgContact" header="#{contactController.dialogTitle}" widgetVar="wDlgContact"  modal="true" >  
                    <p:ajax event="close" update=":createContactForm:iDlgContact" listener="#{contactController.closeDialog}"/>

                    <h:panelGrid columns="2" cellpadding="5">  
                        <h:outputLabel value="#{bundle.Contact_Name}" />  
                        <p:inputText value="#{contactController.newT.name}" />  

                        <h:outputLabel value="#{bundle.Contact_Address}" />  
                        <p:inputText value="#{contactController.newT.address}" />  

                        <h:outputLabel value="#{bundle.Contact_District}" />  
                        <p:inputText value="#{contactController.newT.district}" />  

                        <h:outputLabel value="#{bundle.Contact_City}" />  
                        <p:inputText value="#{contactController.newT.city}" />  

                        <h:outputLabel value="#{bundle.Contact_Postcode}" />  
                        <p:inputText value="#{contactController.newT.postcode}" />  

                        <h:outputLabel value="#{bundle.Contact_Country}" />  
                        <p:inputText value="#{contactController.newT.country}" />  

                        <h:outputLabel value="#{bundle.Contact_MoreInfo}" />  
                        <p:inputText value="#{contactController.newT.moreInfo}" />  

                        <p:commandButton widgetVar="saveContactButton" value="#{bundle.Save}" 
                                         onclick="saveContactButton.disable()"
                                         actionListener="#{contactController.createOrEdit}" 
                                         update="iDlgContact, :ContactListForm:iContactTable, :mainForm:messages" 
                                         oncomplete="saveContactButton.enable(); wDlgContact.hide()" />  

                    </h:panelGrid>  
                </p:dialog>
            </h:form>

            <!-- Contact list -->            
            <h:form id="ContactListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgContactList" header="#{bundle.Contact_ContactList}" widgetVar="wDlgContactList" position="bottom">
                    <p:dataTable id="iContactTable" var="item" value="#{contactController.list}" editable="true"
                                 widgetVar="wContactTable" rowKey="#{item.contactId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No contact found with given criteria" editMode="cell" 
                                 filteredValue="#{contactController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iContactTable" action="#{contactController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wContactTable.filter()" style="width:150px" />                                                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{contactController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column width="50">  
                            <p:commandButton id="deleteButton" update="iContactTable, :mainForm:messages" action="#{contactController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{contactController.selectedT}" />  
                            </p:commandButton>
                            <p:commandButton id="editButton" update=":createContactForm:iDlgContact" action="#{contactController.setEdit}" 
                                             icon="ui-icon-search" title="#{bundle.Edit}" oncomplete="wDlgContact.show()" >                                  
                                <f:setPropertyActionListener value="#{item}" target="#{contactController.selectedT}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="contactIdColumn" sortBy="contactId" filterBy="contactId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px">  
                            <h:outputText value="#{item.contactId}" />  
                        </p:column>  

                        <p:column id="nameColumn" sortBy="name" filterBy="name"   
                                  headerText="#{bundle.Contact_Name}"
                                  filterMatchMode="contains">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.name}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.name}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="addressColumn" sortBy="address" filterBy="address"   
                                  headerText="#{bundle.Contact_Address}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.address}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.address}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="districtColumn" sortBy="district" filterBy="district"   
                                  headerText="#{bundle.Contact_District}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.district}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.district}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="cityColumn" sortBy="city" filterBy="city"   
                                  headerText="#{bundle.Contact_City}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.city}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.city}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="countryColumn" sortBy="country" filterBy="country"   
                                  headerText="#{bundle.Contact_Country}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.country}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.country}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="postcodeColumn" sortBy="postcode" filterBy="postcode"   
                                  headerText="#{bundle.Contact_Postcode}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.postcode}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.postcode}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="moreInfoColumn" sortBy="moreInfo" filterBy="moreInfo"   
                                  headerText="#{bundle.Contact_MoreInfo}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.moreInfo}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.moreInfo}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  
                    </p:dataTable>                     
                </p:dialog>
            </h:form>

            <!-- Create product -->            
            <h:form id="createProductForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgProduct" header="#{productController.dialogTitle}" widgetVar="wDlgProduct"  modal="true" >                    
                    <p:ajax event="close" update=":createProductForm:iDlgProduct" listener="#{productController.closeDialog}"/>                    

                    <h:panelGrid columns="2" cellpadding="5">  
                        <h:outputLabel value="#{bundle.Product_Name}" />  
                        <p:inputText value="#{productController.newT.name}" />  

                        <h:outputLabel value="#{bundle.Product_Manufacturer}" />  
                        <p:inputText value="#{productController.newT.manufacturer}" />  

                        <h:outputLabel value="#{bundle.Product_Unit}" />  
                        <p:inputText value="#{productController.newT.unit}" />  

                        <p:commandButton widgetVar="saveProductButton" value="#{bundle.Save}" 
                                         onclick="saveProductButton.disable()"
                                         actionListener="#{productController.createOrEdit}" 
                                         update="iDlgProduct, :productListForm:iProductTable, :mainForm:messages" 
                                         oncomplete="saveProductButton.enable(); wDlgContact.hide()" />  
                    </h:panelGrid>  
                </p:dialog>                
            </h:form>

            <!-- Product list -->            
            <h:form id="productListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgProductList" header="#{bundle.Product_ProductList}" widgetVar="wDlgProductList" position="bottom" >                    
                    <p:dataTable id="iProductTable" var="item" value="#{productController.list}" editable="true"
                                 widgetVar="wProductTable" rowKey="#{item.productId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No product found with given criteria" editMode="cell" 
                                 filteredValue="#{productController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iProductTable" action="#{productController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />  
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wProductTable.filter()" style="width:150px" />                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{productController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column width="50">  
                            <p:commandButton id="deleteButton" update="iProductTable, :mainForm:messages" action="#{productController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{productController.selectedT}" />  
                            </p:commandButton> 
                            <p:commandButton id="editButton" update=":createProductForm:iDlgProduct" action="#{productController.setEdit}" 
                                             icon="ui-icon-search" title="#{bundle.Edit}" oncomplete="wDlgProduct.show()" >                                  
                                <f:setPropertyActionListener value="#{item}" target="#{productController.selectedT}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="productIdColumn" sortBy="productId" filterBy="productId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px">  
                            <h:outputText value="#{item.productId}" />  
                        </p:column>  

                        <p:column id="nameColumn" sortBy="name" filterBy="name"   
                                  headerText="#{bundle.Product_Name}"
                                  filterMatchMode="contains">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.name}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.name}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="manufacturerColumn" sortBy="manufacturer" filterBy="manufacturer"   
                                  headerText="#{bundle.Product_Manufacturer}"
                                  filterMatchMode="contains" style="width:100px">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.manufacturer}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.manufacturer}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="unitColumn" sortBy="unit" filterBy="unit"   
                                  headerText="#{bundle.Product_Unit}"
                                  filterMatchMode="contains" style="width:80px">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.unit}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.unit}" />  
                                </f:facet>  
                            </p:cellEditor>                             

                        </p:column> 
                    </p:dataTable>  

                    <p:panel header="Export Data">  
                        <p:commandLink id="pdf" ajax="false">  
                            <p:graphicImage value="/images/pdf.png"/>  
                            <pe:exporter type="pdf" target="iProductTable" fileName="products"/>
                        </p:commandLink> 

                        <p:spacer height="20"/>  

                        <p:commandLink id="xls" ajax="false">  
                            <p:graphicImage value="/images/excel.png"/>                              
                            <pe:exporter type="xlsx" target="iProductTable" fileName="products"/>  
                        </p:commandLink>                      
                    </p:panel>  
                </p:dialog>  
            </h:form>

            <!-- Create stock-out -->            
            <h:form id="createSaleForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgSale" header="#{stockOutController.dialogTitle}" widgetVar="wDlgSale"  modal="true" >     

                    <p:ajax event="close" update=":createSaleForm:iDlgSale" listener="#{stockOutController.closeDialog}"/>
                    <p:messages id="msgs" autoUpdate="true"/>
                    <p:panel>    
                        <h:panelGrid columns="5">  
                            <h:outputLabel for="soContactMenu" value="#{bundle.ModuleContact} * :" />  
                            <p:selectOneMenu id="soContactMenu" value="#{stockOutController.newT.contact}" converter="contactConverter" 
                                             panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                             filter="true" filterMatchMode="contains" required="true">                              
                                <f:selectItems value="#{contactController.listOne}" var="c" itemLabel="#{c.contactId} - #{c.name}" itemValue="#{c}"/>  

                                <p:column style="width:15px"> #{p.contactId} </p:column>
                                <p:column> #{p.name} </p:column>
                                <p:column style="width:25px"> #{p.address} </p:column>
                                <p:column style="width:25px"> #{p.city} </p:column>
                                <p:column style="width:25px"> #{p.country} </p:column>

                            </p:selectOneMenu> 
                            <p:spacer width="30"/>
                            <h:outputLabel for="cDate" value="#{bundle.Date} * :" />  
                            <p:calendar id="cDate" locale="de" showButtonPanel="true" navigator="true" 
                                        value="#{stockOutController.newT.date}" required="true" >
                            </p:calendar> 
                        </h:panelGrid>  
                    </p:panel>    

                    <p:panelGrid>  
                        <p:row>  
                            <p:column colspan="4" styleClass="ui-widget-header">

                                <p:dataTable id="iSIOutTable" var="item" value="#{stockOutController.newT.listOfSaleItem}" editable="true"
                                             widgetVar="wSIOutTable" rowKey="#{item.saleItemId}" scrollable="true" scrollHeight="200"
                                             emptyMessage="No sale item found with given criteria" editMode="cell"                                  
                                             resizableColumns="true" liveResize="true" >   

                                    <f:facet name="header">  
                                        <p:outputPanel style="text-align:left"> 
                                            <p:commandButton id="addButton" update="iSIOutTable" action="#{stockOutController.addSaleItem}" icon="ui-icon-circle-plus" title="#{bundle.AddNewItem}" /> 
                                            <p:spacer width="10"/>                                             
                                            <p:commandButton id="refreshButton" update="iSIOutTable,:createSaleForm:oSubTotal, :createSaleForm:oSubTotal, :createSaleForm:oAmountDiscount, :createSaleForm:oAmountVAT, 
                                                             :createSaleForm:oTotal, :createSaleForm:oAmountAfterPayment"
                                                             action="#{productController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" /> 
                                        </p:outputPanel>
                                    </f:facet>

                                    <p:ajax event="cellEdit" listener="#{stockOutController.onSICellEdit}" />                         

                                    <p:column style="width:25px">  
                                        <p:commandButton id="deleteButton" update="iSIOutTable, :mainForm:messages,:createSaleForm:oSubTotal, :createSaleForm:oSubTotal, :createSaleForm:oAmountDiscount, :createSaleForm:oAmountVAT, 
                                                         :createSaleForm:oTotal, :createSaleForm:oAmountAfterPayment"
                                                         action="#{stockOutController.deleteSI}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                            <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                            <f:setPropertyActionListener value="#{item}" target="#{stockOutController.selectedSI}" />  
                                        </p:commandButton> 
                                    </p:column> 


                                    <p:column id="productColumn" headerText="#{bundle.ModuleProduct}">  
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.product.name}" />
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:selectOneMenu id="soProductMenu" value="#{item.product}" converter="productConverter" 
                                                                 panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                                                 filter="true" filterMatchMode="contains" required="true">                              
                                                    <f:selectItems value="#{productController.listOne}" var="pi" itemLabel="#{pi.productId} - #{pi.name}" itemValue="#{pi}"/>  

                                                    <p:column> #{p.productId} </p:column>
                                                    <p:column> #{p.name} </p:column>
                                                    <p:column> #{p.manufacturer} </p:column>
                                                    <p:column> #{p.unit} </p:column>                                        

                                                </p:selectOneMenu>
                                            </f:facet>  
                                        </p:cellEditor>  
                                    </p:column>  

                                    <p:column id="quantityColumn" headerText="#{bundle.Quantity}" style="width:70px; text-align:right">                              
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.quantity}" >
                                                    <f:convertNumber pattern="#,##0.##" />
                                                </h:outputText> 
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:inputText id="iQuantity" value="#{item.quantity}" 
                                                             immediate="true"  >                                          
                                                    <f:convertNumber pattern="#,##0.##" maxFractionDigits="2" maxIntegerDigits="12" />                                        
                                                    <p:ajax event="blur" update="iQuantity, oAmount, 
                                                            :createSaleForm:oSubTotal, :createSaleForm:oAmountDiscount, :createSaleForm:oAmountVAT, 
                                                            :createSaleForm:oTotal, :createSaleForm:oAmountAfterPayment"/> 
                                                </p:inputText>
                                            </f:facet>  
                                        </p:cellEditor>
                                    </p:column>  

                                    <p:column id="priceColumn" headerText="#{bundle.Price}" style="width:70px; text-align:right">                              
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.price}" >
                                                    <f:convertNumber pattern="#,##0" />
                                                </h:outputText> 
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:inputText id="iPrice" value="#{item.price}" 
                                                             immediate="true"  >  
                                                    <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                                                    <f:validateDoubleRange minimum="0" />
                                                    <p:ajax event="blur" update="iPrice, oAmount, 
                                                            :createSaleForm:oSubTotal, :createSaleForm:oAmountDiscount, :createSaleForm:oAmountVAT, 
                                                            :createSaleForm:oTotal, :createSaleForm:oAmountAfterPayment"/> 
                                                </p:inputText>
                                            </f:facet>  
                                        </p:cellEditor>
                                    </p:column>  

                                    <p:column id="discountColumn" headerText="#{bundle.Discount}" style="width:70px; text-align:right">                              
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.discount / 100}" >
                                                    <f:convertNumber pattern="#.##%" type="percent"/>
                                                </h:outputText> 
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:inputText id="iDiscount" value="#{item.discount}" 
                                                             immediate="true"  >  
                                                    <f:convertNumber pattern="#.##" maxFractionDigits="2" />
                                                    <f:validateDoubleRange minimum="0" maximum="100"/>
                                                    <p:ajax event="blur" update="iDiscount, oAmount, 
                                                            :createSaleForm:oSubTotal, :createSaleForm:oAmountDiscount, :createSaleForm:oAmountVAT, 
                                                            :createSaleForm:oTotal, :createSaleForm:oAmountAfterPayment"/> 
                                                </p:inputText>
                                            </f:facet>  
                                        </p:cellEditor>  
                                    </p:column>

                                    <p:column id="amountColumn" headerText="#{bundle.Amount2}" style="width:70px; text-align:right">                              
                                        <h:outputText id="oAmount" value="#{item.amount}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>
                                </p:dataTable>  

                            </p:column>  
                        </p:row>               

                        <p:row>
                            <p:column width="50%" colspan="2" rowspan="6">

                            </p:column>

                            <p:column style="width:200px; text-align:right">
                                <h:outputText value="#{bundle.Subtotal}"/>
                            </p:column>
                            <p:column style="width:100px; text-align:right">
                                <h:outputText id="oSubTotal" value="#{stockOutController.newT.subTotal}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>      
                            <p:column style="text-align:right">                                
                                <h:outputLabel for="iDiscount" value="#{bundle.AdditionalDiscount} (%)" /> 
                                <p:spacer width="20"/>
                                <p:inputText id="iDiscount" value="#{stockOutController.newT.discount}"  style="width:25px; text-align:right">   
                                    <f:convertNumber pattern="#.##" maxFractionDigits="2"/>
                                    <f:validateDoubleRange minimum="0" maximum="100"/>
                                    <p:ajax event="blur" update="iDiscount, oAmountDiscount, oAmountVAT, oTotal, oAmountAfterPayment"/> 
                                </p:inputText>
                            </p:column>
                            <p:column style="text-align:right">
                                <h:outputText id="oAmountDiscount" value="#{stockOutController.newT.amountDiscount}">
                                    <f:convertNumber pattern="-#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right">                                
                                <h:outputLabel for="iVAT" value="#{bundle.VAT} (%)" />  
                                <p:spacer width="20"/>
                                <p:inputText id="iVAT" value="#{stockOutController.newT.VAT}"  style="width:25px; text-align:right">   
                                    <f:convertNumber pattern="#.##" maxFractionDigits="2"/>
                                    <f:validateDoubleRange minimum="0" maximum="100"/>
                                    <p:ajax event="blur" update="iVAT, oAmountVAT, oTotal, oAmountAfterPayment"/> 
                                </p:inputText>
                            </p:column>
                            <p:column style="text-align:right">
                                <h:outputText id="oAmountVAT" value="#{stockOutController.newT.amountVAT}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText value="#{bundle.Total}"/>
                            </p:column>
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText id="oTotal"  value="#{stockOutController.newT.amount}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right">
                                <h:outputLabel for="iPayment" value="#{bundle.Paid}" />  
                            </p:column>
                            <p:column style="text-align:right">
                                -
                                <p:inputText id="iPayment" value="#{stockOutController.newT.payment.amount}"  style="width:70px; text-align:right">   
                                    <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                                    <f:validateDoubleRange minimum="0" />
                                    <p:ajax event="blur" update="iPayment, oAmountAfterPayment"/>                         
                                </p:inputText>                                
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText value="#{bundle.BalanceDue}"/>
                            </p:column>
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText id="oAmountAfterPayment" value="#{stockOutController.newT.amountAfterPayment}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                    </p:panelGrid> 

                    <p:commandButton widgetVar="saveStockOutButton" value="#{bundle.Save}" 
                                     onclick="saveStockOutButton.disable()"
                                     actionListener="#{stockOutController.createOrEdit}" 
                                     update="iDlgSale, :saleListForm:iStockOutTable, :mainForm:messages" 
                                     oncomplete="saveStockOutButton.enable(); wDlgSale.hide()" 
                                     validateClient="true" style="margin-right:10px" />    

                </p:dialog>                
            </h:form>

            <!-- stock-out list -->            
            <h:form id="saleListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgSaleList" header="#{bundle.StockOut_StockOutList}" widgetVar="wDlgSaleList" position="bottom" >
                    <p:dataTable id="iStockOutTable" var="item" value="#{stockOutController.list}" 
                                 widgetVar="wStockOutTable" rowKey="#{item.productTransactionId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No stockIn found with given criteria" 
                                 filteredValue="#{stockOutController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iStockOutTable" action="#{stockOutController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />  
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wStockOutTable.filter()" style="width:150px" />                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{stockOutController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column style="width:52px" exportable="false">  
                            <p:commandButton id="deleteButton" update="iStockOutTable, :mainForm:messages" action="#{stockOutController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{stockOutController.selectedT}" />  
                            </p:commandButton> 
                            <p:commandButton id="editButton" update=":createSaleForm:iDlgSale" action="#{stockOutController.setEdit}" 
                                             icon="ui-icon-search" title="#{bundle.Edit}" oncomplete="wDlgSale.show()" >                                  
                                <f:setPropertyActionListener value="#{item}" target="#{stockOutController.selectedT}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="productTransactionIdColumn" sortBy="productTransactionId" filterBy="productTransactionId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px">  
                            <h:outputText value="#{item.productTransactionId}" />  
                        </p:column>  

                        <p:column id="contactColumn" sortBy="contact.name" filterBy="contact.name"   
                                  headerText="#{bundle.ModuleContact}"
                                  filterMatchMode="contains">                              
                            <h:outputText value="#{item.contact.contactId} - #{item.contact.name}" />  
                        </p:column> 

                        <p:column id="dateColumn" sortBy="date" filterBy="date"   
                                  headerText="#{bundle.Date}" filterMatchMode="contains" style="width:70px">                                    
                            <h:outputText value="#{item.date}"> 
                                <f:convertDateTime pattern="dd.MM.yyyy" />
                            </h:outputText>     
                        </p:column>  

                        <p:column id="amountColumn" sortBy="amount" filterBy="amount"   
                                  headerText="#{bundle.Total}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <h:outputText value="#{item.amount}" >
                                <f:convertNumber pattern="#,##0" />
                            </h:outputText> 
                        </p:column>  

                        <p:column id="paymentColumn" sortBy="payment.amount" filterBy="payment.amount"   
                                  headerText="#{bundle.Payment}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <h:outputText value="#{item.payment.amount}" >
                                <f:convertNumber pattern="#,##0" />
                            </h:outputText> 
                        </p:column>  

                        <p:column id="balanceDueColumn" sortBy="amountAfterPayment" filterBy="amountAfterPayment"   
                                  headerText="#{bundle.BalanceDue}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <h:outputText value="#{item.amountAfterPayment}" >
                                <f:convertNumber pattern="#,##0" />
                            </h:outputText> 
                        </p:column>  
                    </p:dataTable>   

                    <p:panel header="Export Data">  
                        <h:commandLink>  
                            <p:graphicImage value="/images/excel.png" />  
                            <p:dataExporter type="xls" target="iStockOutTable" fileName="StockOutList"/>  
                        </h:commandLink>  
                        <h:commandLink>  
                            <p:graphicImage value="/images/pdf.png" />  
                            <p:dataExporter type="pdf" target="iStockOutTable" fileName="StockOutList"/>  
                        </h:commandLink>  
                    </p:panel>  
                </p:dialog>  
            </h:form>            

            <!-- Create stock-in -->            
            <h:form id="createBuyForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgBuy" header="#{stockInController.dialogTitle}" widgetVar="wDlgBuy" modal="true" >
                    <p:ajax event="close" update=":createBuyForm:iDlgBuy" listener="#{stockInController.closeDialog}"/>
                    <p:messages id="msgs" autoUpdate="true"/>
                    <p:panel>    
                        <h:panelGrid columns="5">  
                            <h:outputLabel for="soContactMenu" value="#{bundle.ModuleContact} * :" />  
                            <p:selectOneMenu id="soContactMenu" value="#{stockInController.newT.contact}" converter="contactConverter" 
                                             panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                             filter="true" filterMatchMode="contains" required="true">                              
                                <f:selectItems value="#{contactController.listOne}" var="c" itemLabel="#{c.contactId} - #{c.name}" itemValue="#{c}"/>  

                                <p:column style="width:15px"> #{p.contactId} </p:column>
                                <p:column> #{p.name} </p:column>
                                <p:column style="width:25px"> #{p.address} </p:column>
                                <p:column style="width:25px"> #{p.city} </p:column>
                                <p:column style="width:25px"> #{p.country} </p:column>

                            </p:selectOneMenu> 
                            <p:spacer width="30"/>
                            <h:outputLabel for="cDate" value="#{bundle.Date} * :" />  
                            <p:calendar id="cDate" locale="de" showButtonPanel="true" navigator="true" 
                                        value="#{stockInController.newT.date}" required="true" >
                            </p:calendar> 
                        </h:panelGrid>  
                    </p:panel>    

                    <p:panelGrid>  
                        <p:row>  
                            <p:column colspan="4" styleClass="ui-widget-header">
                                <p:dataTable id="iSIInTable" var="item" value="#{stockInController.newT.listOfSaleItem}" editable="true"
                                             widgetVar="wSIInTable" rowKey="#{item.saleItemId}" scrollable="true" scrollHeight="200"
                                             emptyMessage="No sale item found with given criteria" editMode="cell"                                  
                                             resizableColumns="true" liveResize="true" >   

                                    <f:facet name="header">  
                                        <p:outputPanel style="text-align:left"> 
                                            <p:commandButton id="addButton" update="iSIInTable" action="#{stockInController.addSaleItem}" icon="ui-icon-circle-plus" title="#{bundle.AddNewItem}" /> 
                                            <p:spacer width="10"/>                                             
                                            <p:commandButton id="refreshButton" update="iSIInTable,:createBuyForm:oSubTotal, :createBuyForm:oSubTotal, :createBuyForm:oAmountDiscount, :createBuyForm:oAmountVAT, 
                                                             :createBuyForm:oTotal, :createBuyForm:oAmountAfterPayment"
                                                             action="#{productController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" /> 
                                        </p:outputPanel>
                                    </f:facet>

                                    <p:ajax event="cellEdit" listener="#{stockInController.onSICellEdit}" />                         

                                    <p:column style="width:25px">  
                                        <p:commandButton id="deleteButton" update="iSIInTable, :mainForm:messages,:createBuyForm:oSubTotal, :createBuyForm:oSubTotal, :createBuyForm:oAmountDiscount, :createBuyForm:oAmountVAT, 
                                                         :createBuyForm:oTotal, :createBuyForm:oAmountAfterPayment"
                                                         action="#{stockInController.deleteSI}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                            <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                            <f:setPropertyActionListener value="#{item}" target="#{stockInController.selectedSI}" />  
                                        </p:commandButton> 
                                    </p:column> 

                                    <p:column id="productColumn" headerText="#{bundle.ModuleProduct}">  
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.product.name}" />
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:selectOneMenu id="soProductMenu" value="#{item.product}" converter="productConverter" 
                                                                 panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                                                 filter="true" filterMatchMode="contains" required="true">                              
                                                    <f:selectItems value="#{productController.listOne}" var="pi" itemLabel="#{pi.productId} - #{pi.name}" itemValue="#{pi}"/>  

                                                    <p:column> #{p.productId} </p:column>
                                                    <p:column> #{p.name} </p:column>
                                                    <p:column> #{p.manufacturer} </p:column>
                                                    <p:column> #{p.unit} </p:column>                                        

                                                </p:selectOneMenu>
                                            </f:facet>  
                                        </p:cellEditor>  
                                    </p:column>  

                                    <p:column id="quantityColumn" headerText="#{bundle.Quantity}" style="width:70px; text-align:right">                              
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.quantity}" >
                                                    <f:convertNumber pattern="#,##0.##" />
                                                </h:outputText> 
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:inputText id="iQuantity" value="#{item.quantity}" 
                                                             immediate="true"  >                                          
                                                    <f:convertNumber pattern="#,##0.##" maxFractionDigits="2" maxIntegerDigits="12" />                                        
                                                    <p:ajax event="blur" update="iQuantity, oAmount, 
                                                            :createBuyForm:oSubTotal, :createBuyForm:oAmountDiscount, :createBuyForm:oAmountVAT, 
                                                            :createBuyForm:oTotal, :createBuyForm:oAmountAfterPayment"/> 
                                                </p:inputText>
                                            </f:facet>  
                                        </p:cellEditor>
                                    </p:column>  

                                    <p:column id="priceColumn" headerText="#{bundle.Price}" style="width:70px; text-align:right">                              
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.price}" >
                                                    <f:convertNumber pattern="#,##0" />
                                                </h:outputText> 
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:inputText id="iPrice" value="#{item.price}" 
                                                             immediate="true"  >  
                                                    <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                                                    <f:validateDoubleRange minimum="0" />
                                                    <p:ajax event="blur" update="iPrice, oAmount, 
                                                            :createBuyForm:oSubTotal, :createBuyForm:oAmountDiscount, :createBuyForm:oAmountVAT, 
                                                            :createBuyForm:oTotal, :createBuyForm:oAmountAfterPayment"/> 
                                                </p:inputText>
                                            </f:facet>  
                                        </p:cellEditor>
                                    </p:column>  

                                    <p:column id="discountColumn" headerText="#{bundle.Discount}" style="width:70px; text-align:right">                              
                                        <p:cellEditor>  
                                            <f:facet name="output">  
                                                <h:outputText value="#{item.discount / 100}" >
                                                    <f:convertNumber pattern="#.##%" type="percent"/>
                                                </h:outputText> 
                                            </f:facet>  
                                            <f:facet name="input">                                      
                                                <p:inputText id="iDiscount" value="#{item.discount}" 
                                                             immediate="true"  >  
                                                    <f:convertNumber pattern="#.##" maxFractionDigits="2" />
                                                    <f:validateDoubleRange minimum="0" maximum="100"/>
                                                    <p:ajax event="blur" update="iDiscount, oAmount, 
                                                            :createBuyForm:oSubTotal, :createBuyForm:oAmountDiscount, :createBuyForm:oAmountVAT, 
                                                            :createBuyForm:oTotal, :createBuyForm:oAmountAfterPayment"/> 
                                                </p:inputText>
                                            </f:facet>  
                                        </p:cellEditor>  
                                    </p:column>

                                    <p:column id="amountColumn" headerText="#{bundle.Amount2}" style="width:70px; text-align:right">                              
                                        <h:outputText id="oAmount" value="#{item.amount}" >
                                            <f:convertNumber pattern="#,##0" />
                                        </h:outputText> 
                                    </p:column>
                                </p:dataTable>  

                            </p:column>  
                        </p:row>               

                        <p:row>
                            <p:column width="50%" colspan="2" rowspan="6">

                            </p:column>

                            <p:column style="width:200px; text-align:right">
                                <h:outputText value="#{bundle.Subtotal}"/>
                            </p:column>
                            <p:column style="width:100px; text-align:right">
                                <h:outputText id="oSubTotal" value="#{stockInController.newT.subTotal}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>      
                            <p:column style="text-align:right">                                
                                <h:outputLabel for="iDiscount" value="#{bundle.AdditionalDiscount} (%)" /> 
                                <p:spacer width="20"/>
                                <p:inputText id="iDiscount" value="#{stockInController.newT.discount}"  style="width:25px; text-align:right">   
                                    <f:convertNumber pattern="#.##" maxFractionDigits="2"/>
                                    <f:validateDoubleRange minimum="0" maximum="100"/>
                                    <p:ajax event="blur" update="iDiscount, oAmountDiscount, oAmountVAT, oTotal, oAmountAfterPayment"/> 
                                </p:inputText>
                            </p:column>
                            <p:column style="text-align:right">
                                <h:outputText id="oAmountDiscount" value="#{stockInController.newT.amountDiscount}">
                                    <f:convertNumber pattern="-#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right">                                
                                <h:outputLabel for="iVAT" value="#{bundle.VAT} (%)" />  
                                <p:spacer width="20"/>
                                <p:inputText id="iVAT" value="#{stockInController.newT.VAT}"  style="width:25px; text-align:right">   
                                    <f:convertNumber pattern="#.##" maxFractionDigits="2"/>
                                    <f:validateDoubleRange minimum="0" maximum="100"/>
                                    <p:ajax event="blur" update="iVAT, oAmountVAT, oTotal, oAmountAfterPayment"/> 
                                </p:inputText>
                            </p:column>
                            <p:column style="text-align:right">
                                <h:outputText id="oAmountVAT" value="#{stockInController.newT.amountVAT}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText value="#{bundle.Total}"/>
                            </p:column>
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText id="oTotal"  value="#{stockInController.newT.amount}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right">
                                <h:outputLabel for="iPayment" value="#{bundle.Paid}" />  
                            </p:column>
                            <p:column style="text-align:right">
                                -
                                <p:inputText id="iPayment" value="#{stockInController.newT.payment.amount}"  style="width:70px; text-align:right">   
                                    <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                                    <f:validateDoubleRange minimum="0" />
                                    <p:ajax event="blur" update="iPayment, oAmountAfterPayment"/>                         
                                </p:inputText>                                
                            </p:column>
                        </p:row>               
                        <p:row>                             
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText value="#{bundle.BalanceDue}"/>
                            </p:column>
                            <p:column style="text-align:right"  styleClass="ui-widget-header">
                                <h:outputText id="oAmountAfterPayment" value="#{stockInController.newT.amountAfterPayment}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText> 
                            </p:column>
                        </p:row>               
                    </p:panelGrid> 

                    <p:commandButton widgetVar="saveStockInButton" value="#{bundle.Save}" 
                                     onclick="saveStockInButton.disable()"
                                     actionListener="#{stockInController.createOrEdit}" 
                                     update="iDlgBuy, :buyListForm:iStockInTable, :mainForm:messages" 
                                     oncomplete="saveStockInButton.enable(); wDlgBuy.hide()" 
                                     validateClient="true" style="margin-right:10px" />    
                </p:dialog>                
            </h:form>

            <!-- stock-in list -->            
            <h:form id="buyListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgBuyList" header="#{bundle.StockIn_StockInList}" widgetVar="wDlgBuyList" position="bottom" >                    
                    <p:dataTable id="iStockInTable" var="item" value="#{stockInController.list}" 
                                 widgetVar="wStockInTable" rowKey="#{item.productTransactionId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No stockIn found with given criteria" 
                                 filteredValue="#{stockInController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iStockInTable" action="#{stockInController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />  
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wStockInTable.filter()" style="width:150px" />                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{stockInController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column style="width:52px" exportable="false">  
                            <p:commandButton id="deleteButton" update="iStockInTable, :mainForm:messages" action="#{stockInController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{stockInController.selectedT}" />  
                            </p:commandButton> 
                            <p:commandButton id="editButton" update=":createBuyForm:iDlgBuy" action="#{stockInController.setEdit}" 
                                             icon="ui-icon-search" title="#{bundle.Edit}" oncomplete="wDlgBuy.show()" >                                  
                                <f:setPropertyActionListener value="#{item}" target="#{stockInController.selectedT}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="productTransactionIdColumn" sortBy="productTransactionId" filterBy="productTransactionId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px">  
                            <h:outputText value="#{item.productTransactionId}" />  
                        </p:column>  

                        <p:column id="contactColumn" sortBy="contact.name" filterBy="contact.name"   
                                  headerText="#{bundle.ModuleContact}"
                                  filterMatchMode="contains">                              
                            <h:outputText value="#{item.contact.contactId} - #{item.contact.name}" />  
                        </p:column> 

                        <p:column id="dateColumn" sortBy="date" filterBy="date"   
                                  headerText="#{bundle.Date}" filterMatchMode="contains" style="width:70px">                                    
                            <h:outputText value="#{item.date}"> 
                                <f:convertDateTime pattern="dd.MM.yyyy" />
                            </h:outputText>     
                        </p:column>  

                        <p:column id="amountColumn" sortBy="amount" filterBy="amount"   
                                  headerText="#{bundle.Total}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <h:outputText value="#{item.amount}" >
                                <f:convertNumber pattern="#,##0" />
                            </h:outputText> 
                        </p:column>  

                        <p:column id="paymentColumn" sortBy="payment.amount" filterBy="payment.amount"   
                                  headerText="#{bundle.Payment}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <h:outputText value="#{item.payment.amount}" >
                                <f:convertNumber pattern="#,##0" />
                            </h:outputText> 
                        </p:column>  

                        <p:column id="balanceDueColumn" sortBy="amountAfterPayment" filterBy="amountAfterPayment"   
                                  headerText="#{bundle.BalanceDue}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <h:outputText value="#{item.amountAfterPayment}" >
                                <f:convertNumber pattern="#,##0" />
                            </h:outputText> 
                        </p:column>  
                    </p:dataTable>   

                    <p:panel header="Export Data">  
                        <h:commandLink>  
                            <p:graphicImage value="/images/excel.png" />  
                            <p:dataExporter type="xls" target="iStockInTable" fileName="StockInList"/>  
                        </h:commandLink>  
                        <h:commandLink>  
                            <p:graphicImage value="/images/pdf.png" />  
                            <p:dataExporter type="pdf" target="iStockInTable" fileName="StockInList"/>  
                        </h:commandLink>  
                    </p:panel>  
                </p:dialog>  
            </h:form>            

            <!-- *************************************************************************************** -->

            <!-- Create Receipt -->            
            <h:form id="createReceiptForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgReceipt" header="#{receiptController.dialogTitle}" widgetVar="wDlgReceipt"  modal="true" >                  
                    <p:ajax event="close" update=":createReceiptForm:iDlgReceipt" listener="#{receiptController.closeDialog}"/>

                    <p:messages id="msgs" autoUpdate="true"/>
                    <h:panelGrid columns="3" cellpadding="5">  

                        <h:outputLabel for="soMenu" value="#{bundle.ModuleContact} *" />                                                 
                        <p:selectOneMenu id="soMenu" value="#{receiptController.newT.contact}" converter="contactConverter" 
                                         panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                         filter="true" filterMatchMode="contains" required="true">                              
                            <f:selectItems value="#{contactController.list}" var="c" itemLabel="#{c.contactId} - #{c.name}" itemValue="#{c}"/>  

                            <p:column> #{p.contactId} </p:column>
                            <p:column> #{p.name} </p:column>
                            <p:column> #{p.address} </p:column>
                            <p:column> #{p.city} </p:column>
                            <p:column> #{p.country} </p:column>

                        </p:selectOneMenu>
                        <p:message for="soMenu" display="icon"/>

                        <h:outputLabel for="cDate" value="#{bundle.Date} *" />  
                        <p:calendar id="cDate" locale="de" showButtonPanel="true" navigator="true" 
                                    value="#{receiptController.newT.date}" required="true" >


                        </p:calendar>    
                        <p:message for="cDate" display="icon"/>

                        <h:outputLabel for="iAmount" value="#{bundle.Amount} *" />  
                        <p:inputText id="iAmount" value="#{receiptController.newT.amount}" 
                                     required="true" immediate="true" >  
                            <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                            <f:validateDoubleRange minimum="1" />
                            <p:ajax event="blur" update="iAmount"/> 
                        </p:inputText>
                        <p:message for="iAmount" display="icon"/>

                        <h:outputLabel for="iReason" value="#{bundle.Reason}" />  
                        <p:inputText id="iReason" value="#{receiptController.newT.paymentReason}" />  

                        <p:spacer width="5"/>
                        <p:commandButton widgetVar="saveReceiptButton" value="#{bundle.Save}" 
                                         onclick="saveReceiptButton.disable()"
                                         actionListener="#{receiptController.createOrEdit}" 
                                         update="iDlgReceipt, :receiptListForm:iReceiptTable, :mainForm:messages" 
                                         oncomplete="saveReceiptButton.enable(); wDlgReceipt.hide()" 
                                         validateClient="true" style="margin-right:10px" />  
                    </h:panelGrid>     
                </p:dialog>                
            </h:form>

            <!-- Receipt list -->            
            <h:form id="receiptListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgReceiptList" header="#{bundle.Receipt_ReceiptList}" widgetVar="wDlgReceiptList" position="bottom" >
                    <p:dataTable id="iReceiptTable" var="item" value="#{receiptController.list}" editable="true"
                                 widgetVar="wReceiptTable" rowKey="#{item.paymentTransactionId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No receipt found with given criteria" editMode="cell" 
                                 filteredValue="#{receiptController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iReceiptTable" action="#{receiptController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />  
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wReceiptTable.filter()" style="width:150px" />                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{receiptController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column style="width:52px">  
                            <p:commandButton id="deleteButton" update="iReceiptTable, :mainForm:messages" action="#{receiptController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{receiptController.selectedT}" />  
                            </p:commandButton>
                            <p:commandButton id="editButton" update=":createReceiptForm:iDlgReceipt" action="#{receiptController.setEdit}" 
                                             icon="ui-icon-search" title="#{bundle.Edit}" oncomplete="wDlgReceipt.show()" >                                  
                                <f:setPropertyActionListener value="#{item}" target="#{receiptController.selectedT}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="paymentTransactionIdColumn" sortBy="paymentTransactionId" filterBy="paymentTransactionId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px">  
                            <h:outputText value="#{item.paymentTransactionId}" />  
                        </p:column>  

                        <p:column id="contactColumn" sortBy="contact.name" filterBy="contact.name"   
                                  headerText="#{bundle.ModuleContact}"
                                  filterMatchMode="contains">                              
                            <h:outputText value="#{item.contact.contactId} - #{item.contact.name}" />  
                        </p:column> 

                        <p:column id="dateColumn" sortBy="date" filterBy="date"   
                                  headerText="#{bundle.Date}"
                                  filterMatchMode="contains" style="width:70px">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.date}"> 
                                        <f:convertDateTime pattern="dd.MM.yyyy" />
                                    </h:outputText>                                     
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:calendar locale="de" showButtonPanel="true" navigator="true" value="#{item.date}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="amountColumn" sortBy="amount" filterBy="amount"   
                                  headerText="#{bundle.Amount}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.amount}" >
                                        <f:convertNumber pattern="#,##0" />
                                    </h:outputText> 
                                </f:facet>  
                                <f:facet name="input">                                      
                                    <p:inputText id="iAmount" value="#{item.amount}" required="true" 
                                                 immediate="true"  >  
                                        <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                                        <f:validateDoubleRange minimum="1" />
                                        <p:ajax event="blur" update="iAmount"/> 
                                    </p:inputText>
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="paymentReasonColumn" sortBy="paymentReason" filterBy="paymentReason"   
                                  headerText="#{bundle.Reason}"
                                  filterMatchMode="contains" style="width:150px" >  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.paymentReason}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.paymentReason}" />  
                                </f:facet>  
                            </p:cellEditor>                             

                        </p:column> 

                    </p:dataTable> 
                </p:dialog>  
            </h:form>            

            <!-- Create payment -->            
            <h:form id="createPaymentForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgPayment" header="#{paymentController.dialogTitle}" widgetVar="wDlgPayment"  modal="true" >   
                    <p:ajax event="close" update=":createPaymentForm:iDlgPayment" listener="#{paymentController.closeDialog}"/>                    

                    <p:messages id="msgs" autoUpdate="true"/>
                    <h:panelGrid columns="3" cellpadding="5">  

                        <h:outputLabel for="soMenu" value="#{bundle.ModuleContact} *" />                                                 
                        <p:selectOneMenu id="soMenu" value="#{paymentController.newT.contact}" converter="contactConverter" 
                                         panelStyle="width:500px" effect="fade" var="p" style="width:160px"  
                                         filter="true" filterMatchMode="contains" required="true">                              
                            <f:selectItems value="#{contactController.list}" var="c" itemLabel="#{c.contactId} - #{c.name}" itemValue="#{c}"/>  

                            <p:column> #{p.contactId} </p:column>
                            <p:column> #{p.name} </p:column>
                            <p:column> #{p.address} </p:column>
                            <p:column> #{p.city} </p:column>
                            <p:column> #{p.country} </p:column>

                        </p:selectOneMenu>
                        <p:message for="soMenu" display="icon"/>

                        <h:outputLabel for="cDate" value="#{bundle.Date} *" />  
                        <p:calendar id="cDate" locale="de" showButtonPanel="true" navigator="true" 
                                    value="#{paymentController.newT.date}" required="true" >


                        </p:calendar>    
                        <p:message for="cDate" display="icon"/>

                        <h:outputLabel for="iAmount" value="#{bundle.Amount} *" />  
                        <p:inputText id="iAmount" value="#{paymentController.newT.amount}" 
                                     required="true" immediate="true" >  
                            <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                            <f:validateDoubleRange minimum="1" />
                            <p:ajax event="blur" update="iAmount"/> 
                        </p:inputText>
                        <p:message for="iAmount" display="icon"/>

                        <h:outputLabel for="iReason" value="#{bundle.Reason}" />  
                        <p:inputText id="iReason" value="#{paymentController.newT.paymentReason}" />  

                        <p:spacer width="5"/>
                        <p:commandButton widgetVar="savePaymentButton" value="#{bundle.Save}" 
                                         onclick="savePaymentButton.disable()"
                                         actionListener="#{paymentController.createOrEdit}" 
                                         update="iDlgPayment, :paymentListForm:iPaymentTable, :mainForm:messages" 
                                         oncomplete="savePaymentButton.enable(); wDlgPayment.hide()" 
                                         validateClient="true" style="margin-right:10px" />  
                    </h:panelGrid>  
                </p:dialog>                
            </h:form>

            <!-- payment list -->            
            <h:form id="paymentListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgPaymentList" header="#{bundle.Payment_PaymentList}" widgetVar="wDlgPaymentList" position="bottom" >
                    <p:dataTable id="iPaymentTable" var="item" value="#{paymentController.list}" editable="true"
                                 widgetVar="wPaymentTable" rowKey="#{item.paymentTransactionId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No payment found with given criteria" editMode="cell" 
                                 filteredValue="#{paymentController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iPaymentTable" action="#{paymentController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />  
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wPaymentTable.filter()" style="width:150px" />                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{paymentController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column style="width:52px">  
                            <p:commandButton id="deleteButton" update="iPaymentTable, :mainForm:messages" action="#{paymentController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{paymentController.selectedT}" />  
                            </p:commandButton> 
                            <p:commandButton id="editButton" update=":createPaymentForm:iDlgPayment" action="#{paymentController.setEdit}" 
                                             icon="ui-icon-search" title="#{bundle.Edit}" oncomplete="wDlgPayment.show()" >                                  
                                <f:setPropertyActionListener value="#{item}" target="#{paymentController.selectedT}" />  
                            </p:commandButton> 

                        </p:column> 

                        <p:column id="paymentTransactionIdColumn" sortBy="paymentTransactionId" filterBy="paymentTransactionId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains" style="width:60px">  
                            <h:outputText value="#{item.paymentTransactionId}" />  
                        </p:column>  

                        <p:column id="contactColumn" sortBy="contact.name" filterBy="contact.name"   
                                  headerText="#{bundle.ModuleContact}"
                                  filterMatchMode="contains">                              
                            <h:outputText value="#{item.contact.contactId} - #{item.contact.name}" />  
                        </p:column> 

                        <p:column id="dateColumn" sortBy="date" filterBy="date"   
                                  headerText="#{bundle.Date}"
                                  filterMatchMode="contains" style="width:70px">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.date}"> 
                                        <f:convertDateTime pattern="dd.MM.yyyy" />
                                    </h:outputText>                                      
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:calendar locale="de" showButtonPanel="true" navigator="true" value="#{item.date}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  


                        <p:column id="amountColumn" sortBy="amount" filterBy="amount"   
                                  headerText="#{bundle.Amount}"
                                  filterMatchMode="contains" style="width:80px; text-align:right">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.amount}" >
                                        <f:convertNumber pattern="#,##0" />
                                    </h:outputText> 
                                </f:facet>  
                                <f:facet name="input">                                      
                                    <p:inputText id="iAmount" value="#{item.amount}" required="true" 
                                                 immediate="true"  >  
                                        <f:convertNumber pattern="#,##0" maxIntegerDigits="12" />
                                        <f:validateDoubleRange minimum="1" />
                                        <p:ajax event="blur" update="iAmount"/> 
                                    </p:inputText>
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="paymentReasonColumn" sortBy="paymentReason" filterBy="paymentReason"   
                                  headerText="#{bundle.Reason}"
                                  filterMatchMode="contains" style="width:150px" >  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.paymentReason}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.paymentReason}" />  
                                </f:facet>  
                            </p:cellEditor>                             

                        </p:column> 

                    </p:dataTable>  
                </p:dialog>  
            </h:form>                

        </h:body>        
    </ui:composition>        
</html>