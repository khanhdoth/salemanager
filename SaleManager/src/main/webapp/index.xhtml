<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:fn="http://java.sun.com/jsp/jstl/functions">

    <ui:composition>

        <h:head>
            <title>#{bundle.App}</title>                
        </h:head>

        <h:body>
            <h:outputStylesheet name="css/default.css" />

            <p:ajaxStatus style="width:1px;height:1px;" id="ajaxStatusPanel">  
                <f:facet name="start">  
                    <h:graphicImage value="images/ajax_loader.gif" />  
                </f:facet>  

                <f:facet name="complete">  
                    <h:outputText value="" />  
                </f:facet>  
            </p:ajaxStatus> 

            <!-- menu -->            
            <h:form id="menuForm" onkeypress="return event.keyCode != 13;">
                <p:menubar autoDisplay="false">  
                    <p:submenu label="#{bundle.ModuleContact}" >  
                        <p:menuitem value="#{bundle.Contact_NewContact}" icon="ui-icon-document" onclick="wDlgContact.show()" />  
                        <p:menuitem value="#{bundle.Contact_ContactList}" icon="ui-icon-document" onclick="wDlgContactList.show()" /> 
                    </p:submenu>  

                    <p:submenu label="#{bundle.ModuleProduct}">  
                        <p:menuitem value="#{bundle.Product_NewProduct}" icon="ui-icon-document" onclick="wDlgProduct.show()" /> 
                        <p:menuitem value="#{bundle.Product_ProductList}" icon="ui-icon-document" onclick="wDlgProductList.show()" /> 
                    </p:submenu>  
                    <p:menuitem value="#{bundle.Quit}" url="http://vannga.com" />  

                    <f:facet name="options">  
                        <p:inputText style="margin-right:10px"/>  
                        <p:commandButton type="button" value="#{bundle.Logout}" icon="ui-icon-extlink" />  
                    </f:facet>  
                </p:menubar>            
            </h:form>

            <!-- Main form -->            
            <h:form id="mainForm" onkeypress="return event.keyCode != 13;">                
                <p:growl id="messages" showDetail="true"/>

                <!-- Confirmation -->            
                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">  
                    <p:commandButton value="#{bundle.Yes}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>  
                    <p:commandButton value="#{bundle.No}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>       
                </p:confirmDialog>  
            </h:form>

            <!-- Create contact -->            
            <h:form id="createContactForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgContact" header="#{bundle.Contact_NewContact}" widgetVar="wDlgContact">                    
                    <h:panelGrid columns="2" cellpadding="5">  
                        <h:outputLabel value="#{bundle.Contact_Name}" />  
                        <p:inputText value="#{contactController.newContact.name}" />  

                        <h:outputLabel value="#{bundle.Contact_Address}" />  
                        <p:inputText value="#{contactController.newContact.address}" />  

                        <h:outputLabel value="#{bundle.Contact_District}" />  
                        <p:inputText value="#{contactController.newContact.district}" />  

                        <h:outputLabel value="#{bundle.Contact_City}" />  
                        <p:inputText value="#{contactController.newContact.city}" />  

                        <h:outputLabel value="#{bundle.Contact_Postcode}" />  
                        <p:inputText value="#{contactController.newContact.postcode}" />  

                        <h:outputLabel value="#{bundle.Contact_Country}" />  
                        <p:inputText value="#{contactController.newContact.country}" />  

                        <h:outputLabel value="#{bundle.Contact_MoreInfo}" />  
                        <p:inputText value="#{contactController.newContact.moreInfo}" />  

                        <p:commandButton widgetVar="saveContactButton" value="#{bundle.Save}" 
                                         onclick="saveContactButton.disable()"
                                         actionListener="#{contactController.createContact}" 
                                         update="iDlgContact, :ContactListForm:iContactTable, :mainForm:messages" 
                                         oncomplete="saveContactButton.enable(); wDlgContact.hide()" />  

                    </h:panelGrid>  
                </p:dialog>
            </h:form>

            <!-- Contact list -->            
            <h:form id="ContactListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog header="#{bundle.Contact_ContactList}" widgetVar="wDlgContactList" position="bottom">
                    <p:dataTable id="iContactTable" var="item" value="#{contactController.list}" editable="true"
                                 widgetVar="wContactTable" rowKey="#{item.contactId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No contact found with given criteria" editMode="cell" 
                                 filteredValue="#{contactController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iContactTable" action="#{contactController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wContactTable.filter()" style="width:150px" />                                                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{contactController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column style="width:5%">  
                            <p:commandButton id="deleteButton" update="iContactTable, :mainForm:messages" action="#{contactController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{contactController.selectedContact}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="contactIdColumn" sortBy="contactId" filterBy="contactId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains">  
                            <h:outputText value="#{item.contactId}" />  
                        </p:column>  

                        <p:column id="nameColumn" sortBy="name" filterBy="name"   
                                  headerText="#{bundle.Contact_Name}"
                                  filterMatchMode="contains">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.name}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.name}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="addressColumn" sortBy="address" filterBy="address"   
                                  headerText="#{bundle.Contact_Address}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.address}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.address}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="districtColumn" sortBy="district" filterBy="district"   
                                  headerText="#{bundle.Contact_District}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.district}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.district}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="cityColumn" sortBy="city" filterBy="city"   
                                  headerText="#{bundle.Contact_City}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.city}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.city}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="countryColumn" sortBy="country" filterBy="country"   
                                  headerText="#{bundle.Contact_Country}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.country}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.country}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="postcodeColumn" sortBy="postcode" filterBy="postcode"   
                                  headerText="#{bundle.Contact_Postcode}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.postcode}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.postcode}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="moreInfoColumn" sortBy="moreInfo" filterBy="moreInfo"   
                                  headerText="#{bundle.Contact_MoreInfo}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.moreInfo}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.moreInfo}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  
                    </p:dataTable>                     
                </p:dialog>
            </h:form>

            <!-- Create product -->            
            <h:form id="createProductForm" onkeypress="return event.keyCode != 13;">
                <p:dialog id="iDlgProduct" header="#{bundle.Product_NewProduct}" widgetVar="wDlgProduct">                    
                    <h:panelGrid columns="2" cellpadding="5">  
                        <h:outputLabel value="#{bundle.Product_Name}" />  
                        <p:inputText value="#{productController.newProduct.name}" />  

                        <h:outputLabel value="#{bundle.Product_Manufacturer}" />  
                        <p:inputText value="#{productController.newProduct.manufacturer}" />  

                        <h:outputLabel value="#{bundle.Product_Unit}" />  
                        <p:inputText value="#{productController.newProduct.unit}" />  

                        <p:commandButton widgetVar="saveProductButton" value="#{bundle.Save}" 
                                         onclick="saveProductButton.disable()"
                                         actionListener="#{productController.createProduct}" 
                                         update="iDlgProduct, :productListForm:iProductTable, :mainForm:messages" 
                                         oncomplete="saveProductButton.enable(); wDlgContact.hide()" />  
                    </h:panelGrid>  
                </p:dialog>                
            </h:form>

            <!-- Product list -->            
            <h:form id="productListForm" onkeypress="return event.keyCode != 13;">
                <p:dialog header="#{bundle.Product_ProductList}" widgetVar="wDlgProductList" position="bottom" >                    
                    <p:dataTable id="iProductTable" var="item" value="#{productController.list}" editable="true"
                                 widgetVar="wProductTable" rowKey="#{item.productId}" scrollable="true" scrollHeight="400"
                                 emptyMessage="No product found with given criteria" editMode="cell" 
                                 filteredValue="#{productController.filterList}"                                 
                                 resizableColumns="true" liveResize="true" >   

                        <f:facet name="header">  
                            <p:outputPanel style="text-align:left"> 
                                <p:commandButton id="refreshButton" update="iProductTable" action="#{productController.refreshList}" icon="ui-icon-refresh" title="#{bundle.Reresh}" />  
                                <p:spacer width="20"/>
                                <h:outputText value="#{bundle.Search}" />
                                <p:spacer width="5"/>
                                <p:inputText id="globalFilter" onkeyup="wProductTable.filter()" style="width:150px" />                            
                            </p:outputPanel>
                        </f:facet>

                        <p:ajax event="cellEdit" listener="#{productController.onCellEdit}" update=":mainForm:messages" /> 

                        <p:column style="width:5%">  
                            <p:commandButton id="deleteButton" update="iProductTable, :mainForm:messages" action="#{productController.delete}" icon="ui-icon-trash" title="#{bundle.Delete}" >  
                                <p:confirm header="#{bundle.Confirmation}" message="#{bundle.Delete_Confirm_Message}" icon="ui-icon-alert" />  
                                <f:setPropertyActionListener value="#{item}" target="#{productController.selectedProduct}" />  
                            </p:commandButton> 
                        </p:column> 

                        <p:column id="productIdColumn" sortBy="productId" filterBy="productId"   
                                  headerText="#{bundle.ID}" filterMatchMode="contains">  
                            <h:outputText value="#{item.productId}" />  
                        </p:column>  

                        <p:column id="nameColumn" sortBy="name" filterBy="name"   
                                  headerText="#{bundle.Product_Name}"
                                  filterMatchMode="contains">                                    
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.name}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.name}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="manufacturerColumn" sortBy="manufacturer" filterBy="manufacturer"   
                                  headerText="#{bundle.Product_Manufacturer}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.manufacturer}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.manufacturer}" />  
                                </f:facet>  
                            </p:cellEditor>                             
                        </p:column>  

                        <p:column id="unitColumn" sortBy="unit" filterBy="unit"   
                                  headerText="#{bundle.Product_Unit}"
                                  filterMatchMode="contains">  
                            <p:cellEditor>  
                                <f:facet name="output">  
                                    <h:outputText value="#{item.unit}" />  
                                </f:facet>  
                                <f:facet name="input">  
                                    <p:inputText value="#{item.unit}" />  
                                </f:facet>  
                            </p:cellEditor>                             

                        </p:column> 
                    </p:dataTable>  
                </p:dialog>  
            </h:form>

        </h:body>        
    </ui:composition>        
</html>

